from binaryFunctions import get_binary_string, set_bit, get_bit, add_binary

def descramble(data):
    mask = 0b00111111111111111111111111111111
    DataOut = 0b000000000000000000000000000000
    S_reg = 0b0101010101010101010101011101010101010101010101010101010101
    S_wire = S_reg
    words = []
    for DataIn in data:
        DataIn = int(DataIn, 16)
        DataIn = DataIn & mask
        DataOut = set_bit(DataOut,  0, get_bit(S_reg, 57) ^ get_bit(S_reg, 38) ^ get_bit(DataIn,  0))
        DataOut = set_bit(DataOut,  1, get_bit(S_reg, 56) ^ get_bit(S_reg, 37) ^ get_bit(DataIn,  1))
        DataOut = set_bit(DataOut,  2, get_bit(S_reg, 55) ^ get_bit(S_reg, 36) ^ get_bit(DataIn,  2))
        DataOut = set_bit(DataOut,  3, get_bit(S_reg, 54) ^ get_bit(S_reg, 35) ^ get_bit(DataIn,  3))
        DataOut = set_bit(DataOut,  4, get_bit(S_reg, 53) ^ get_bit(S_reg, 34) ^ get_bit(DataIn,  4))
        DataOut = set_bit(DataOut,  5, get_bit(S_reg, 52) ^ get_bit(S_reg, 33) ^ get_bit(DataIn,  5))
        DataOut = set_bit(DataOut,  6, get_bit(S_reg, 51) ^ get_bit(S_reg, 32) ^ get_bit(DataIn,  6))
        DataOut = set_bit(DataOut,  7, get_bit(S_reg, 50) ^ get_bit(S_reg, 31) ^ get_bit(DataIn,  7))
        DataOut = set_bit(DataOut,  8, get_bit(S_reg, 49) ^ get_bit(S_reg, 30) ^ get_bit(DataIn,  8))
        DataOut = set_bit(DataOut,  9, get_bit(S_reg, 48) ^ get_bit(S_reg, 29) ^ get_bit(DataIn,  9))
        DataOut = set_bit(DataOut, 10, get_bit(S_reg, 47) ^ get_bit(S_reg, 28) ^ get_bit(DataIn, 10))
        DataOut = set_bit(DataOut, 11, get_bit(S_reg, 46) ^ get_bit(S_reg, 27) ^ get_bit(DataIn, 11))
        DataOut = set_bit(DataOut, 12, get_bit(S_reg, 45) ^ get_bit(S_reg, 26) ^ get_bit(DataIn, 12))
        DataOut = set_bit(DataOut, 13, get_bit(S_reg, 44) ^ get_bit(S_reg, 25) ^ get_bit(DataIn, 13))
        DataOut = set_bit(DataOut, 14, get_bit(S_reg, 43) ^ get_bit(S_reg, 24) ^ get_bit(DataIn, 14))
        DataOut = set_bit(DataOut, 15, get_bit(S_reg, 42) ^ get_bit(S_reg, 23) ^ get_bit(DataIn, 15))
        DataOut = set_bit(DataOut, 16, get_bit(S_reg, 41) ^ get_bit(S_reg, 22) ^ get_bit(DataIn, 16))
        DataOut = set_bit(DataOut, 17, get_bit(S_reg, 40) ^ get_bit(S_reg, 21) ^ get_bit(DataIn, 17))
        DataOut = set_bit(DataOut, 18, get_bit(S_reg, 39) ^ get_bit(S_reg, 20) ^ get_bit(DataIn, 18))
        DataOut = set_bit(DataOut, 19, get_bit(S_reg, 38) ^ get_bit(S_reg, 19) ^ get_bit(DataIn, 19))
        DataOut = set_bit(DataOut, 20, get_bit(S_reg, 37) ^ get_bit(S_reg, 18) ^ get_bit(DataIn, 20))
        DataOut = set_bit(DataOut, 21, get_bit(S_reg, 36) ^ get_bit(S_reg, 17) ^ get_bit(DataIn, 21))
        DataOut = set_bit(DataOut, 22, get_bit(S_reg, 35) ^ get_bit(S_reg, 16) ^ get_bit(DataIn, 22))
        DataOut = set_bit(DataOut, 23, get_bit(S_reg, 34) ^ get_bit(S_reg, 15) ^ get_bit(DataIn, 23))
        DataOut = set_bit(DataOut, 24, get_bit(S_reg, 33) ^ get_bit(S_reg, 14) ^ get_bit(DataIn, 24))
        DataOut = set_bit(DataOut, 25, get_bit(S_reg, 32) ^ get_bit(S_reg, 13) ^ get_bit(DataIn, 25))
        DataOut = set_bit(DataOut, 26, get_bit(S_reg, 31) ^ get_bit(S_reg, 12) ^ get_bit(DataIn, 26))
        DataOut = set_bit(DataOut, 27, get_bit(S_reg, 30) ^ get_bit(S_reg, 11) ^ get_bit(DataIn, 27))
        DataOut = set_bit(DataOut, 28, get_bit(S_reg, 29) ^ get_bit(S_reg, 10) ^ get_bit(DataIn, 28))
        DataOut = set_bit(DataOut, 29, get_bit(S_reg, 28) ^ get_bit(S_reg,  9) ^ get_bit(DataIn, 29))
        DataOut = add_binary(0b10, DataOut, 30)
        words.append(hex(DataOut))
    
        S_wire = set_bit(S_wire,  0, get_bit(DataIn, 29))
        S_wire = set_bit(S_wire,  1, get_bit(DataIn, 28))
        S_wire = set_bit(S_wire,  2, get_bit(DataIn, 27))
        S_wire = set_bit(S_wire,  3, get_bit(DataIn, 26))
        S_wire = set_bit(S_wire,  4, get_bit(DataIn, 25))
        S_wire = set_bit(S_wire,  5, get_bit(DataIn, 24))
        S_wire = set_bit(S_wire,  6, get_bit(DataIn, 23))
        S_wire = set_bit(S_wire,  7, get_bit(DataIn, 22))
        S_wire = set_bit(S_wire,  8, get_bit(DataIn, 21))
        S_wire = set_bit(S_wire,  9, get_bit(DataIn, 20))
        S_wire = set_bit(S_wire, 10, get_bit(DataIn, 19))
        S_wire = set_bit(S_wire, 11, get_bit(DataIn, 18))
        S_wire = set_bit(S_wire, 12, get_bit(DataIn, 17))
        S_wire = set_bit(S_wire, 13, get_bit(DataIn, 16))
        S_wire = set_bit(S_wire, 14, get_bit(DataIn, 15))
        S_wire = set_bit(S_wire, 15, get_bit(DataIn, 14))
        S_wire = set_bit(S_wire, 16, get_bit(DataIn, 13))
        S_wire = set_bit(S_wire, 17, get_bit(DataIn, 12))
        S_wire = set_bit(S_wire, 18, get_bit(DataIn, 11))
        S_wire = set_bit(S_wire, 19, get_bit(DataIn, 10))
        S_wire = set_bit(S_wire, 20, get_bit(DataIn,  9))
        S_wire = set_bit(S_wire, 21, get_bit(DataIn,  8))
        S_wire = set_bit(S_wire, 22, get_bit(DataIn,  7))
        S_wire = set_bit(S_wire, 23, get_bit(DataIn,  6))
        S_wire = set_bit(S_wire, 24, get_bit(DataIn,  5))
        S_wire = set_bit(S_wire, 25, get_bit(DataIn,  4))
        S_wire = set_bit(S_wire, 26, get_bit(DataIn,  3))
        S_wire = set_bit(S_wire, 27, get_bit(DataIn,  2))
        S_wire = set_bit(S_wire, 28, get_bit(DataIn,  1))
        S_wire = set_bit(S_wire, 29, get_bit(DataIn,  0))
        S_wire = set_bit(S_wire, 30, get_bit(S_reg,   0))
        S_wire = set_bit(S_wire, 31, get_bit(S_reg,   1))
        S_wire = set_bit(S_wire, 32, get_bit(S_reg,   2))
        S_wire = set_bit(S_wire, 33, get_bit(S_reg,   3))
        S_wire = set_bit(S_wire, 34, get_bit(S_reg,   4))
        S_wire = set_bit(S_wire, 35, get_bit(S_reg,   5))
        S_wire = set_bit(S_wire, 36, get_bit(S_reg,   6))
        S_wire = set_bit(S_wire, 37, get_bit(S_reg,   7))
        S_wire = set_bit(S_wire, 38, get_bit(S_reg,   8))
        S_wire = set_bit(S_wire, 39, get_bit(S_reg,   9))
        S_wire = set_bit(S_wire, 40, get_bit(S_reg,  10))
        S_wire = set_bit(S_wire, 41, get_bit(S_reg,  11))
        S_wire = set_bit(S_wire, 42, get_bit(S_reg,  12))
        S_wire = set_bit(S_wire, 43, get_bit(S_reg,  13))
        S_wire = set_bit(S_wire, 44, get_bit(S_reg,  14))
        S_wire = set_bit(S_wire, 45, get_bit(S_reg,  15))
        S_wire = set_bit(S_wire, 46, get_bit(S_reg,  16))
        S_wire = set_bit(S_wire, 47, get_bit(S_reg,  17))
        S_wire = set_bit(S_wire, 48, get_bit(S_reg,  18))
        S_wire = set_bit(S_wire, 49, get_bit(S_reg,  19))
        S_wire = set_bit(S_wire, 50, get_bit(S_reg,  20))
        S_wire = set_bit(S_wire, 51, get_bit(S_reg,  21))
        S_wire = set_bit(S_wire, 52, get_bit(S_reg,  22))
        S_wire = set_bit(S_wire, 53, get_bit(S_reg,  23))
        S_wire = set_bit(S_wire, 54, get_bit(S_reg,  24))
        S_wire = set_bit(S_wire, 55, get_bit(S_reg,  25))
        S_wire = set_bit(S_wire, 56, get_bit(S_reg,  26))
        S_wire = set_bit(S_wire, 57, get_bit(S_reg,  27))
        
        S_reg = S_wire      
    
    return words[2:-1]
